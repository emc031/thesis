\chapter{Lattice Calculations}
\label{chap:latticecalculations}

The last chapter focused on how to discretize the QCD action. This chapter is focused on the practical side of lattice QCD - given a lattice action, how does one perform the functional integral to determine expectation values?

\section{Evaluation of Lattice Correlation Functions}

All physics of a quantum field theory can be extracted from correlation functions. So a typical lattice calculation involves computing a correlation function (or just {\it{correlator}}) on the lattice, then extracting physical quantities from it. A typical correlator that is computed on the lattice is a 2-point meson correlator, i.e. $\langle\Phi(x)\Phi^{\dagger}(y)\rangle$ where $\Phi$ is a meson creation operator and $\Phi^{\dagger}$ is an annihilation operator. This is a good working example for showing the steps in a lattice calculation, the generalization to $N$-point correlators is reasonably natural.

A creation/annihilation operator for a meson in this context can be any operator containing the same quantum numbers as the meson one studying. For example, the neutral $B$ meson is a pseudoscalar charged with a $b$ and $\bar{d}$ quark, so a suitable operator is $\Phi(x) = \bar{b}(x)\gamma_5 d(x)$. The corresponding functional can then be written as
\begin{align}
  \nonumber
  C(x,y) = \langle \Phi(x)\Phi^{\dagger}(y)\rangle =& \int [d\psi d\bar{\psi} dU] \left(\, \bar{b}(x)\gamma_5 d(x) \bar{d}(y)\gamma_5 b(y) \text{ }\right) \\&\times \exp\left(-S_G[U]-\sum_{w,z,i} \bar{q}_i(w)M_{q_i}(w,z)[U]q_i(z)\right),
\end{align}
where we have broken the action up into a gauge part $S_G[U]$, and a fermion part. $M_{q_i}(x,y)[U]$ is the Dirac operator for flavour $i$, and can be seen as a matrix in lattice site, color and spin.

The integral over fermions can be performed analytically since the fermion fields are Grassman valued. In our example, the result is \cite{Peskin:1995ev}:
\begin{align}
  \nonumber
  C(x,y) = \int [dU]\, &\text{Tr}\left( \, M^{-1}_b(y,x)[U] \, \gamma_5 \, M^{-1}_d(x,y)[U] \, \gamma_5 \, \right) \\ &\times e^{-S_G[U]} \prod_i\text{det}(M_{q_i}[U])\,.
  \label{eq:lattice_correlator}
\end{align}
The quantinties $M_{q_i}^{-1}(x,y)[U]$ are propagators of a quark of flavour $q$ on a fixed gauge background $U$. For clarity: here $U$ denotes a configuration of angles comprising an $SU(3)$ matrix for each element of the set of all links on the lattice $\{ U_{\mu}(x) | \,\forall \,\mu,\,x \}$. The trace is over color and spin. The integration over gauge fields is generally carried out by an importance sampling method. A finite \textit{ensemble} of gauge configurations $\{U_n\}$ is generated by a Monte Carlo Markov Chain (MCMC), where the probability of a gauge configuration $U_n$ being added to the ensemble is proportional to
\begin{align}
  p(U_n) = e^{-S_G[U_n]}\prod_i\text{det}(M_{q_i}[U_n]).
  \label{eq:MCweight}
\end{align}

Once the ensemble is created, the path integral can be approximated by simply
\begin{align}
  C(x,y) \simeq {1\over N} \sum_n \text{ Tr}\left[\text{ } M^{-1}_b(y,x)[U_n] \gamma_5 M^{-1}_d(x,y)[U_n] \gamma_5 \text{ }\right]\,,
  \label{eq:av_gauge}
\end{align}
where $N$ is the number of configurations in the ensemble. The calculation of the correlation function then is split into 3 steps:
\begin{enumerate}
\item
  Generate an ensemble of gauge configurations $\{ U_i \}$ by MCMC (Sec. \ref{sec:MCMC}).
\item
  Compute $M^{-1}_{q_i}(x,y)[U]$ by inverting the Dirac operator on each gauge configuration (Sec. \ref{sec:inversions}).
\item
  Construct the trace in Eq. \eqref{eq:av_gauge}, and average over the ensemble. This step is dealt with in the context of staggered quarks in Sec. \ref{sec:staggeredcorrelators}.
\end{enumerate}


\subsection{Generation of Gauge Ensembles}
\label{sec:MCMC}

The calculation requires a number of samples of gauge configurations $\{U_n\}$ sampled from the distribution $p(U)$ defined in Eq. \eqref{eq:MCweight}. In this section (Sec. \ref{sec:MCMC}) I largely follow the discussion given in \cite{DeGrand:2006zz}.

The physical interpretation of the determinant in \eqref{eq:MCweight} is that it accounts for virtual quark loops in gluon propagators. In the early days of lattice calculations, this determinant was approximated to 1, since its evaluation was an insurmountable computational cost, and it was expected that sea quarks had small effects on observables (this is known as the {\it{quenched approximation}}). However, this introduced large systematic effects that could not be well controlled. These days, our computational ability has improved and sophisticated approaches to computing the determinant have been developed, so we can include it in our calculations.

We will roughly follow the history of gauge ensemble generation, by first ignoring the determinant, and then showing how it is eventually included in the process.

\subsubsection{Quenched MCMC}

Gauge ensembles are generated via an MCMC, inspired by statistical mechanics. The distribution exp$(-S_G[U])$ is suggestive of something like a Boltzmann distribution for a gas of particles, each with some state $U_i$, in thermal equilibrium. The ergodic hypothesis states that a single particle in this gas will jump between possible states over time such that, at any given time, its probability of being in state $U_i$ is given by exp$(-S_G[U_i])$. In MCMC, one starts with some random state $U_0$, then repeatedly updates the state according to some update rule or 'hopping rate' $p(U_i\to U_j)$. 

The hopping rate must be designed to bring the chain into thermal equilibrium with the correct distribution. A sufficient condition for thermal equilibrium is known as {\it{detailed balance}}, where the probability of jumps between any pair of states $i$ and $j$ is equal:
\begin{align}
  p(U_i) p(U_i\to U_j) = p(U_j) p(U_j\to U_i)\,.
\end{align}
Hence $p(U_i\to U_j)$ must be designed according to the rule
\begin{align}
  {p(U_i\to U_j) \over p(U_j\to U_i)} = \exp(-(S_G[U_i]-S_G[U_j]))\,.
  \label{eq:detailed_balance}
\end{align}
There are a number of possible choices of how to design $p(U_i\to U_j)$. One approach, called {\bf{molecular dynamics}} \cite{PhysRevLett.49.613,PhysRevD.28.1506} is to model the chain as the trajectory $U(\tau)$ of a system with Hamiltonian
\begin{align}
  H(\pi,U) = {\pi^2\over 2} + S_G[U]\,,
\end{align}
where $\pi$ is a fictitious momentum conjugate to $U$. It can be demonstrated that such a trajectory obeys \eqref{eq:detailed_balance} \cite{PhysRevLett.49.613}. The trajectory is computed via Runge-Kutta numerical integration. One may worry about the possibility of fixed points, limit cycles etc. in the dynamics, which would prevent ergodicity. To avoid this one can introduce a periodic {\bf{refreshing}} step, where $\pi$ assigned a new value from normally distributed noise \cite{PhysRevLett.55.2774,duane1986}.

Another problem that can occur in molecular dynamics is when errors in Runge-Kutta iterations accumulate over time. Diversion from the dynamics enforced by $H(\pi,U)$ can ruin the ergodicity of the trajectory. To fix this, one can add a {\bf{Metropolis}} step at regular intervals $\delta\tau$ throughout the evolution \cite{doi:10.1063/1.1699114}. In this step, one either accepts (continues onto the next stage of molecular dynamics) or rejects (refreshes $\pi$ and re-calculates the $\delta \tau$ worth of molecular dynamics), according to the criterion
\begin{itemize}
\item
  If $S_G[U(\tau+\delta\tau)] < S_G[U(\tau)]$, always accept.
\item
  Otherwise, accept if $\,\exp\left(S_G[U(\tau+\delta\tau)] - S_G[U(\tau)]\right) > \lambda$, where $\lambda$ is randomly chosen from the interval $[0,1]$.
\end{itemize}
The metropolis step ensures detailed balance (Eq. \eqref{eq:detailed_balance}) is satisfied even in the presence of Runge-Kutta errors.

The combination of molecular dynamics, refreshing steps and Metropolis steps is referred to as {\bf{Hybrid Monte Carlo}} \cite{DUANE1987216}, and is the basic structure of how the ensembles we use in this thesis were generated. I now address how the determinant det$M$ is included.

\subsubsection{Unquenched MCMC}

Simply evaluating det$M[U]$ directly, given a configuration $U$, is prohibitively expensive due to the non-local nature of the determinant. Recall $M[U]$ is a matrix in spin, colour, and lattice site, in modern calculations this will have a dimension of order $10^8$. Even holding that much information in memory is not feasible. A solution to this is to use the $\Phi$-algorithm \cite{PhysRevD.35.2531}.

First, we replace det$M$ with det$M^{\dagger}M$. If we were only including $u$ and $d$ quarks in the sea, this would be fine since we can approximate $u$ and $d$ to be two degenerate flavours, then $\prod_q \det M_q = \det M \det M = \det M^{\dagger} M$. In the case of an arbitrary set of flavours, this requires a correction that will be addressed later.
The $\Phi-$algorithm involves introducing new artificial scalar fields $\Phi(x)$ and $\Phi^{\dagger}(x)$ via
\begin{align}
  \det M^{\dagger} M = \int [d\Phi^{\dagger}d\Phi] \exp(-\Phi^{\dagger} (M^{\dagger}M)^{-1}\Phi).
\end{align}
then one can add $\Phi^{\dagger} (M^{\dagger}M)^{-1}\Phi$ to $S_G$ in the Hybrid Monte Carlo algorithm. The extra functional integral over $\Phi,\Phi^{\dagger}$ is easly evaluated, by sampling a vector $\eta$ from a normal distribution exp$(-\eta^{\dagger}\eta)$, then transforming it to $\Phi = M^{\dagger} \eta$.

\subsubsection{The dreaded Rooting Trick}

We will now address how to correct for the fact that we have replaced det$M$ with det$M^{\dagger}M$ in the presence of arbitrary non-degenerate flavours. We have explicitly doubled the fermions to two degenerate flavours per physical flavour. In the case of staggered quarks, this is not a huge marginal complication since we already have four degenerate tastes which we have to deal with anyway. In order to cut down the number of tastes in the sea, the solution is to take the fourth-root of det$M$. When using the $\Phi$-algorithm, this becomes the 8th root of det$M^{\dagger}M$.
\begin{align}
  (\det M^{\dagger} M )^{1/8} &= (\prod_i \lambda_i^2)^{1/8} = (\prod_i \lambda_i)^{1/4} \\ \nonumber &\stackrel{?}{=} (\prod_i\lambda_i^{'\,4})^{1/4} = \prod_i \lambda'_i \quad (a\to 0).
\end{align}
where $\lambda_i$ are eigenvalues of $M$. On the second line, we have assumed that the matrix $M$ can be decomposed into four matrices, one for each of the four tastes, with eigenvalues $\lambda'_i$ which are degenerate in the continuum limit.

This assumption is not rigorously justified in field theory, so the fourth-root trick is a source of controversy. Much has been said about the problems this may cause in lattice results \cite{JANSEN20043,CREUTZ2007230,Creutz:2007rk}, however, these concerns have been refuted \cite{Kronfeld:2007ek,Sharpe:2006re}. It has been demonstrated that the eigenvalues smoothly become degenerate as one approaches the continuum limit \cite{Follana:2004sz,Donald:2011if}.
There has so far emerged no evidence that the rooting trick is harmful, observables computed using unquenched staggered quarks have always agreed with experiment, analytical approaches (e.g. \cite{Durr:2012te}), and other lattice discretisations. 

Introducing the $1/2$ or $1/8$th root to the determinant requires a modification of the $\Phi$-algorithm, we can no longer simply sample $\Phi$ using $\Phi=M^{\dagger}\eta$. The effective action is now $S_G + \Phi^{\dagger} (M^{\dagger}M)^{-1/8} \Phi$. The root is dealt with by replacing it with a partial fraction representation \cite{Clark:2006fx}:
\begin{align}
  (M^{\dagger}M)^{-1/8} \simeq a_0 + \sum_{n=1}^N { a_n \over M^{\dagger}M + b_n }.
  \label{eq:rational}
\end{align}
This can only be evaluated by some variation of a conjugate gradient algorithm (specifically a multishift solver \cite{Frommer:1995ik,Jegerlehner:1996pm}). Conjugate gradient will be described in Sec. \ref{sec:inversions}. This approach is called the {\bf{Rational Hybrid Monte Carlo}} (RHMC) algorithm.

\subsubsection{The $N_f=2+1+1$ MILC Ensembles}
\label{sec:MILCensembles}

In this work, we use ensembles of gauge configurations generated by the MILC collaboration \cite{Bazavov:2012xda,Bazavov:2010ru}. The ingredients of these configurations are
\begin{itemize}
\item
  Gauge fields obeying the one-loop Symanzik improved L\"uscher-Weitz action described in Sec. \ref{sec:symanzik_gauge}.
\item
  Four flavours of quark in the sea, $u$,$d$,$s$ and $c$ (with $m_u=m_d\equiv m_l$), hence the notation $N_f=2+1+1$, obeying the HISQ action, described in sec. \ref{sec:HISQ}.
\item
  Ensemble generated (mostly) using the RHMC algorithm as described earlier in this section. Some configurations on set 3 were instead generated using an RHMD algorithm - similar to RHMC except with the Metropolis accept/reject step omitted.
\end{itemize}
Table \ref{tab:ensembles} gives the details of the MILC ensembles that were used in this work. One may notice that for the majority of ensembles here, the light quarks are obscenely heavier than in reality. The necessity for this is explained in the next section.

\begin{table*}[t]
  \begin{center}
    \begin{tabular}{c c c c c c c c c c}
      \hline
      set & handle & $w_0/a$  & $N_x^3\times N_t$ & $am_{l0}$ & $am_{s0}$ & $am_{c0}$  \\ [0.5ex]
      \hline
      0 & \bf{very coarse} & 1.1119(10) & $16^3\times48$ & 0.013 & 0.067 & 0.838 \\ [1ex]
      1 & \bf{coarse} & 1.3826(11) & $24^3\times64$ & 0.0102 & 0.0509 & 0.635 \\ [1ex]
      2 & \bf{fine} & 1.9006(20) & $32^3\times96$ & 0.0074 & 0.037 & 0.440 \\ [1ex]
      3 & \bf{fine-physical} & 1.9518(7) & $64^3\times96$ & 0.0012 & 0.0363 & 0.432 \\ [1ex]
      4 & \bf{superfine} & 2.896(6) & $48^3\times144$ & 0.0048 & 0.024 & 0.286 \\ [1ex]
      5 & \bf{ultrafine} & 3.892(12) &  $64^3\times192$ & 0.00316 & 0.0158 & 0.188  \\ [1ex]
      \hline
    \end{tabular}
  \end{center}
  \caption{Parameters for the MILC gluon ensembles \cite{Bazavov:2010ru,Bazavov:2012xda}. $a$ is the lattice spacing, determined from the Wilson flow parameter $w_0$. Values for $w_0/a$ are from: sets 0,1,2 \cite{Chakraborty:2016mwy}, sets 3 and 4 \cite{Chakraborty:2014aca}, set 5 \cite{mcneile:private}. The physical value of $w_0$ was determined to be $w_0=0.1715(9)$fm in \cite{Dowdall:2013rya}. Columns 5-7 give the masses used in the action for light,strange and charm quarks in the sea. \label{tab:ensembles}}
\end{table*}


\subsection{Dirac Operator Inversion}
\label{sec:inversions}

Once the ensemble $\{U_i\}$ has been generated, to compute the 2-point correlator \eqref{eq:av_gauge} one must compute $M^{-1}[U_i]$ for each $U_i$. We have already seen how this can be done in the case of the flavour in question being governed by the NRQCD action, one can use the recursion relation \eqref{eq:nrqcd_recursion}. In the case of relativistic actions like HISQ, there is no equivalent recursion relation.

$M$ is large but sparse. It technically has $\order{\text{Vol}^2}$ elements, but for suitably local actions (like HISQ) it has only $\order{\text{Vol}}$ non-zero elements. This means it is well-suited to the {\bf{conjugate gradient}} (CG) algorithm \cite{Hestenes&Stiefel:1952} (and its variants), which has become the most successful approach to computing $M^{-1}$. However, CG requires the matrix being inverted to be hermitian and positive definate, which is not necessarily the case for $M$. We instead invert $M^{\dagger}M$, which {\it{is}} hermitian and positive definate, then we can recover $M^{-1}$ by acting $M^{\dagger}$ on $(M^{\dagger}M)^{-1}$.

The design of CG requires a bunch of explanation which I will not go into here. I will instead briefly describe the philosophy behind it, and state the algorithm. For a nice review with lots of detail see \cite{Shewchuk94anintroduction}. The goal is, given some vector $b$ and matrix $A$, to find $x$ where
\begin{align}
  Ax = b\,.
\end{align}
In our case $A=M^{\dagger}M$ and $b$ is a suitably chosen 'source' for the propagator (see Sec. \ref{sec:staggeredcorrelators}). This is equivalent to finding the $x=x^*$ that minimizes
\begin{align}
  f(x) = {1\over2}x^TAx - b^Tx.
\end{align}
A reasonable solution to this problem is something like a {\it{steepest descent}} approach, where one starts at a random $x_0$, then moves some distance $\alpha_0$ in the direction $r_0 = -f'(x_0) = b-Ax_0$ to $x_1=x_0+\alpha_0 r_0$. $\alpha_0$ is chosen to minimize $x^*-x_1$. And then repeat. This approach has the property that each new step $\alpha_n r_n$ is orthogonal to every other step, this means the algorithm takes a sub-optimal zig-zag path towards the solution.

CG is designed to take a more direct path, by imposing the condition that the direction of each step $d_n=(x_n-x_{n-1})/\alpha_n$ is orthogonal with respect to the metric $A$, i.e. $d^T_n A d_m = 0$ for $n\neq m$. The CG algorithm is
\begin{align}
  \nonumber
  x_{n+1} &= x_n + \alpha_n d_n\,, \text{ where } \\
  \nonumber
  &\alpha_n = {r^T_n r_n \over d^T_n A d_n^T}\,, \\
  \nonumber
  &d_n=
  \begin{cases}
    r_0\,, &  n=0 \\
    r_{n} + \beta_n d_{n-1}\,, & n>0\,,
  \end{cases} \\
  \nonumber
  &r_n = b - Ax_n\,, \\
  &\beta_n = {r^T_n r_n \over r^T_{n-1}r_{n-1}}\,.
  \label{eq:CG}
\end{align}
One terminates the algorithm when some stopping condition is acheived, namely when $r_n < \epsilon$ where $\epsilon$ is some small number referred to as the error tolerance, or when some maximum number of iterations has been reached.

The complexity of the CG algorithm is $\order{c}$ where $c=\lambda_{\text{max}}/\lambda_{\text{min}}$ is the condition number of the matrix $A$. $\lambda_{\text{max/min}}$ are the largest and smallest eigenvalues of $A$. The condition number quantifies the size of rounding errors that accumulate in iterative processes like CG. In our case where $A=M^{\dagger}M  \sim(-i\slashed{D}+m)(i\slashed{D}+m)$, the condition number is proportional to $m^{-2}$. Hence, propagators for lighter quarks are quadratically more expensive to compute than heavier ones. This affects the computation of correlation functions including light valence quarks via $M_l^{-1}$. It also affects any unquenched calculation with rooting since in that case we must also perform an inversion to evaluate \eqref{eq:rational}.

For this reason, lattice calculations are often computed with unphysically heavy $u/d$ quarks. Modern lattice calculations have computed observables for a number of light quark masses and extrapolated downwards to the physical light mass, using chiral perturbation theory as a guide. In the MILC ensembles we use in this work, summarized in Table \ref{tab:ensembles}, all but one have a light mass at around $m_l/m_s \simeq 1/5$, while set 3 (fine-physical) has roughly physical light quarks at $m_l/m_s \simeq 1/30$.


\subsection{Staggered Correlation Functions}
\label{sec:staggeredcorrelators}

We now turn to how to evaluate traces of quark propagators, like in Eq. \eqref{eq:lattice_correlator}, in the staggered formalism. %Recall in the staggered formalism we replace the Dirac spinor $\psi(x)$ with a single-component staggered quark via $\psi(x)=\gamma_x \chi(x)$. Then, we can gather up all of the spin structure in the resulting $\gamma$'s and the spin trace can be evaluated to obtain a so-called {\it{staggered phase}}.

Recall from Sec. \ref{sec:staggeredquarks}, propagators for naive quarks $M^{-1}$ are related to staggered propagators $g$ by
\begin{align}
  M^{-1}(x,y) = \Omega(x)\Omega^{\dagger}(y) g(x,y).
\end{align}
Throughout this section we will keep the gauge field dependence of $M^{-1}$ and $g$ implicit. By conjugating both sides and using the property of the naive propagator $(M^{-1})^{\dagger}(x,y) = \gamma_5 M^{-1}(y,x)\gamma_5$ one can show that $M^{-1}$ can also be written as
\begin{align}
  \label{eq:Gconj}
  M^{-1}(y,x) = \phi_5(y)\phi_5(x) \Omega(y)\Omega^{\dagger}(x) g^{\dagger}(x,y),
\end{align}
where $\phi_5(x) = (-1)^{\sum_{\mu} x_{\mu}/a}$.

\subsubsection{2-point Correlation Functions}

Consider the generic 2-point correlator; involving two valence flavours $a$ and $b$, and spin structure $\gamma_X$ and $\gamma_Y$ at the source and sink:
\begin{align}
  C(x,y) &= \langle \Phi^{\dagger}_X(x) \Phi_Y(y) \rangle_{\psi,U} \quad , \quad \Phi_X(x) = {1\over 4}\bar{\psi}_a(x) \gamma_X \psi_b(x) \\
  \nonumber
  &= {1\over 16}\langle \text{Tr}_{c,s} \gamma_X M^{-1}_{a}(x,y) \gamma_Y M^{-1}_{b}(y,x) \rangle_U \\
  &= {1\over 16}\phi_5(x)\phi_5(y)\text{Tr}_s \left( \Omega^{\dagger}(x) \gamma_X \Omega(x) \Omega^{\dagger}(y) \gamma_Y \Omega(y) \right)
  \langle \text{Tr}_c \left( g_{a}(x,y) g^{\dagger}_{b}(x,y) \right) \rangle_U\,. \nonumber
\end{align}
$\text{Tr}_s$ is a trace over spin and $\text{Tr}_c$ is over color. We have applied Eq. \eqref{eq:Gconj} to the $b$ propagator in the last line. To deal with the spin trace, define the family of phases $\{\phi_X(x)\}$ according to
\begin{align}
  \Omega^{\dagger}(x)\gamma_X\Omega(x) = \phi_X(x) \gamma_X.
\end{align}
for example, if $X=5$, then $\gamma^{\dagger}_x\gamma_5\gamma_x = (-1)^{\sum_{\mu}x_{\mu}} \gamma^{\dagger}_x\gamma_x \gamma_5 = \phi_5(x) \gamma_5$. The map from $X$ to $\phi_X$ is structure preserving, i.e. if $\gamma_X=\gamma_A\gamma_B$, then $\phi_X(x)=\phi_A(x)\phi_B(x)$. The spin trace becomes $\phi_X(x)\phi_Y(y) \text{Tr}_s\left( \gamma_X \gamma_Y \right)$. The remaining trace will vanish unless $Y=X$, and is 4 otherwise. We end up with
\begin{align}
  C(x,y) = {1\over 4} \phi_{5X}(x)\phi_{5Y}(y) \langle \,\text{Tr}_c \,g_a(x,y) g^{\dagger}_b(x,y) \,\rangle_U.
\end{align}
We are usually interested instead in the correlation function of a meson in a momentum eigenstate with spacial momentum ${\textbf{p}}$. This will take the form
\begin{align}
  \nonumber
  C_{\textbf{p}}(t_0,t) &= {1\over N_x^3} \sum_{{\textbf{x}},{\textbf{y}}} e^{i{\textbf{p}}\cdot({\textbf{x}}-{\textbf{y}})}
  C({\textbf{x}},t_0;{\textbf{y}},t) \\
  &= {1\over 4 N_x^3} \sum_{{\textbf{x}},{\textbf{y}}} e^{i{\textbf{p}}\cdot({\textbf{x}}-{\textbf{y}})} \phi_{5X}(x)\phi_{5Y}(y) \langle \,\text{Tr}_c \,g_a(x,y)g^{\dagger}_b(x,y)\,\rangle_U,
\end{align}
where it is understood that $x_0=t_0$ and $y_0=t$. In order to evaluate this function, we must perform inversions to create $g_{a/b}(x,y)$ for each $x$ and $y$, so $2\cdot$Vol$^2$ calculations. This is prohibitively expensive. The number of inversions can be reduced by using {\it{random wall sources}}. Define
\begin{align}
  P^{t_0}_{a,{\textbf{p}},X}(y) \equiv {1\over \sqrt{N_x^3}} \sum_{\textbf{x}} e^{i{\textbf{p}}\cdot ({\textbf{x}}-{\textbf{y}})} \phi_{5X}({\textbf{x}},t_0) \xi({\textbf{x}}) g_a({\textbf{x}},t_0;y)\,,
  \label{eq:onesided_prop}
\end{align}
where $\xi({\textbf{x}})$ is a random field of colour vectors, a different field for each gauge configuration. This has the property
\begin{align}
  \langle f({\textbf{x}},{\textbf{x}}') \xi^*({\textbf{x}}')\xi({\textbf{x}})\rangle_U = \delta_{{\textbf{x}},{\textbf{x}}'} \langle f({\textbf{x}},{\textbf{x}}') \rangle_U\,.
\end{align}
Using this property the correlator can be built instead according to
\begin{align}
  \boxed{\quad  \quad C_{\textbf{p}}(t_0,t) = {1\over 4} \sum_{\textbf{y}} \phi_{5Y}(y) \langle \,\text{Tr}_c \, P^{t_0}_{a,{\textbf{p}},X}({\textbf{y}},t) P^{t_0\,\dagger}_{b,{\textbf{0}},5}({\textbf{y}},t) \,\rangle_U. \quad}
  \label{eq:tietogether}
\end{align}
Now all one has to compute is $P^{t_0}_{a/b}(y)$ for general $y$, so $2\cdot$(Vol) calculations, a reduction by a factor of (Vol).

\subsubsection{3-point Correlation Functions}

The above discussion can be generalized to 3-(or $N$-)point correlation functions. Consider a 3-point correlation function, for example encoding an $X\to Y$ semileptonic decay via a current $J(y)$:
\begin{align}
  C(x,y,z) = \langle \Phi^{\dagger}_X(x) J(y) \Phi_Z(z) \rangle_{\psi,U} \,,\quad \quad \Phi_X(x) &= {1\over 4} \bar{\psi}_b(x) \gamma_X \psi_s(x) \\
  \nonumber
  J(y) &= \bar{\psi}_b(y)\gamma_J\psi_a(y) \\
  \nonumber
  \Phi_Z(z) &= {1\over 4}\bar{\psi}_a(z)\gamma_Z \psi_s(z)\,.
\end{align}
We can reduce this in the same way as before
\begin{align}
  C(x,y,z) = {1\over 16}& \text{Tr}_s\left( \Omega^{\dagger}(x) \gamma_X \Omega(x) \Omega^{\dagger}(y) \gamma_J \Omega(y) \Omega^{\dagger}(z) \gamma_Z \Omega(z) \right) \\ \nonumber &\times \phi_5(x)\phi_5(z)\langle \,\text{Tr}_c\, g_{b}(x,y) g_{a}(y,z) g^{\dagger}_{s}(x,z)\,\rangle_U \\
  = {1\over 4}& \phi_{5X}(x) \phi_J(y) \phi_{5Z}(z) \langle \,\text{Tr}_c\, g_{b}(x,y) g_{a}(y,z) g^{\dagger}_{s}(x,z) \,\rangle_U\,.
\end{align}
We have assumed that $\text{Tr}_s \gamma_X\gamma_J\gamma_Z = 4$, requiring that each gamma matrix in this combination has a partner and therefore cancels.

Putting the $X$-meson into an eigenstate of zero momentum, and the $Y$-meson into an eigenstate of momentum ${\textbf{p}}$, we get
\begin{align}
  \nonumber
  C_{\textbf{p}}(t_0,t,T) =& {1\over 4 N_x^3} \sum_{{\textbf{x}},{\textbf{y}},{\textbf{z}}} e^{i{\textbf{p}}\cdot({\textbf{y}}-{\textbf{z}})} \phi_{5X}(x) \phi_J(y) \phi_{5Z}(z) \\ &\times\langle\, \text{Tr}_c\, g_{b}({\textbf{x}},t_0;{\textbf{y}},t) g_{a}({\textbf{y}},t;{\textbf{z}},T) g^{\dagger}_{s}({\textbf{x}},t_0;{\textbf{z}},T) \,\rangle_U\,.
  \label{eq:3ptfullexpr}
\end{align}
This can be built by first creating propagators for the $b$ and $s$ quarks - $P^{t_0}_{b,{\textbf{0}},X}(y)$,$P^{t_0}_{s,{\textbf{0}},1}(z)$. Then, build the $a$ propagator using a so-called {\textit{extended source}}:
\begin{align}
  P^T_{a,{\textbf{p}},ext}(y) = \sum_{{\textbf{z}}} P^{t_0\,\dagger}_{s,{\textbf{0}},5}({\textbf{z}},T) \phi_{Z}({\textbf{z}},T) e^{i{\textbf{p}}\cdot({\textbf{y}}-{\textbf{z}})}\,\,g_{a}(y;{\textbf{z}},T)\,.
\end{align}
We can build the 3-point correlator \eqref{eq:3ptfullexpr} using essentially the same 'tie together' as \eqref{eq:tietogether}:
\begin{align}
  C_{\textbf{p}}(t_0,t,T) = {1\over 4}\sum_{\textbf{y}} \phi_J(y) \langle\,\text{Tr}_c\, P^{t_0}_{b,{\textbf{0}},5X}({\textbf{y}},t) P^T_{a,{\textbf{p}},ext}({\textbf{y}},t) \,\rangle_U\,.
\end{align}

I'll briefly connect the above discussion to the spin-taste notation introduced in Sec. \ref{sec:staggeredquarks}. In the above, we have not used any point-split operators. Hence, we denote these operators in spin-taste notation as $(\gamma_n\otimes \gamma_n)$, where $\gamma_n$ is the continuum spin structure we are aiming for. In the work in this thesis, we will not use any point-split operators, so the above discussion is sufficient for understanding the methods used.

\subsubsection{Momentum Twist}
\label{sec:momentum_twist}

The way in which spacial momentum is introduced into the correlation functions requires some explanation. The momentum space 2-point correlation function for an operator $\mathcal{O}$ with momentum ${\textbf{p}}$ is given by
\begin{align}
  C_{\textbf{p}}(0,t) = \sum_{{\textbf{x}}} e^{i{\textbf{p}}\cdot{\textbf{x}}} \langle \mathcal{O}^{\dagger} ({\textbf{x}},t) \mathcal{O}({\textbf{0}},0) \rangle.
\end{align}
To introduce ${\textbf{p}}$ one can add an appropriate phase to the operators:
\begin{align}
  \label{eq:phirephase}
  &\mathcal{O}({\textbf{x}},t) \rightarrow \mathcal{O}({\textbf{x}},t)e^{-i{\textbf{p}}\cdot{\textbf{x}}} \\
  \implies &C({\textbf{0}},t) \rightarrow C({\textbf{p}},t).
\end{align}
This generalizes straightforwardly to $n$-point functions. One can assign the rephasing to any factor in $\mathcal{O}$, for example a fermion operator
\begin{align}
  \psi({\textbf{x}},t) \rightarrow \psi({\textbf{x}},t)e^{-i{\textbf{p}}\cdot{\textbf{x}}}.
  \label{eq:fermion_phase}
\end{align}
Rephasing $\psi$ is equivalent to introducing a {\it{momentum twist}} to the gauge links \cite{Guadagnoli:2005be}. The action of Eq. \eqref{eq:fermion_phase} on any gauge invariant quantity is equivalent to
\begin{align}
  U_i \rightarrow U_i e^{iap_i}\quad\text{(no sum)}.
  \label{eq:twist}
\end{align}
For example, consider the effect this has on the following operator
\begin{align}
  \nonumber
  &\psi^{\dagger}(x) U_{\mu}(x) \psi(x+a\hat{\mu}) \\
  \nonumber
  \rightarrow &\psi^{\dagger}(x) \big( e^{iap_{\mu}}U_{\mu}(x) \big) \psi(x+a\hat{\mu})
  \\
  = &\psi^{\dagger}(x)e^{-i{\textbf{p}\cdot\textbf{x}}}U_{\mu}(x) e^{+i{\textbf{p}\cdot(\textbf{x}}+a\hat{\mu})}\psi(x+a\hat{\mu})\,.
\end{align}
When computing a propagator $g_a(x,y)$, we add these phases to the gauge fields which have the effect of the flavour $a$ carrying the spacial momentum. This is how momentum is included in the work of this thesis. We report momentum twist in units of $\pi/N_x$, e.g., a twist of $\theta$ in the $k$ direction corresponds to a momentum of $ap_k = \pi\theta/N_k$.

\section{Analysis of Correlation Functions}

Once correlation functions like $C_{\textbf{p}}(t_0,t)$ and $C_{\textbf{p}}(t_0,t,T)$ have been computed on the lattice, how can we extract physics from them?

\subsection{Fitting Correlation Functions}
\label{sec:correlator_fits}

2-point correlators contain information about (amongst other things) masses and decay constants of the propagating meson. One performs a $\chi^2-$fit of the correlator to a theoretically motivated function of $t$. To derive such a function, we use a complete set of momentum ${\textbf{p}}$ states -
\begin{align}
  1 = \sum_{n=0}^{\infty} {1\over 2E_n} | \lambda_n \rangle \langle \lambda_n |,
\end{align}
where $E_n$ are the energies of each state. Inserting this into the correlation function, and moving from the Heisenberg to Schr\"odinger picture \cite{Weber:2013eba}:
\begin{align}
  C_{\textbf{p}}(t) = \langle& \Omega | \Phi({\textbf{p}},t) \Phi^{\dagger}({\textbf{p}},0)|\Omega\rangle \nonumber \\
  =\sum_{n=0}^{N_{\text{exp}}} & {1\over 2E_n} \langle \Omega | \left( e^{Ht} + e^{H(T_{\text{lat}}-t)} \right)  \Phi({\textbf{p}},0) \left( e^{-Ht} + e^{-H(T_{\text{lat}}-t)} \right) | \lambda_n \rangle
  \nonumber
  \\
  &\times \langle \lambda_n | \Phi^{\dagger}({\textbf{p}},0) | \Omega \rangle
  \nonumber
  \\  = \sum_{n=0}^{N_{\text{exp}}} & \left( {\langle \Omega | \Phi({\textbf{p}},0) | \lambda_n \rangle \over \sqrt{2E_n}} \right) \left( {\langle \lambda_n | \Phi^{\dagger}({\textbf{p}},0) | \Omega \rangle \over \sqrt{2E_n} } \right) \left( e^{-\bar{E}_n t} + e^{-\bar{E}_n (T_{\text{lat}}-t)} \right)
  \nonumber
  \\[10pt] \equiv \sum_{n=0}^{N_{\text{exp}}} & |a_n|^2 f(\bar{E}_n,t) \quad,\quad f(E,t) = \left( e^{-E t} + e^{-E(T_{\text{lat}}-t)} \right),
  \label{eq:multiexponential}
\end{align}
where $T_{\text{lat}}=aN_t$ is the temporal extent of the lattice. I have here set $t_0=0$ for clarity. In practice, one would only use 'late time' data,  $t\geq t_{\text{cut}}$ for some $t_{\text{cut}}$. In the late time data the correlator is dominated by the lowest-$n$ terms, since higher $n$ terms are suppressed by faster decaying exponentials exp$(-\bar{E}_nt)$. Hence we can afford to truncate the sum at some finite number of terms, $N_{\text{exp}}$. 

The fit results in a determination of the parameters $a_n$ and $\bar{E}_n$. The sum over $n$ will be populated only by states $|\lambda_n\rangle$ with the same quantum numbers as $\Phi$, since $\langle\Omega | \Phi | \lambda_n \rangle$ vanishes in all other cases. We can then interpret $|\lambda_0\rangle$ to be the ground state of the meson we are studying. 

I'm maintaining a distinction between $\bar{E}_n$ and $E_n$ here, since these differ in calculations involving NRQCD quarks. In NRQCD $\bar{E}_n$ is the non-relativistic energy with leading-$v$ behaviour ${\textbf{p}}^2/2m$.

In the HISQ case, one can safely interpret these as relativistic energies, $\bar{E}_n=E_n$. One can find the meson's mass by computing the correlation function at zero momentum $C_{{\textbf{0}}}(t)$, the fit parameter $\bar{E}_0$ will equal the mass $M$. $a_n$ can be related to the meson's decay constant. For example for a pseudoscalar meson, using the definition of a meson decay constant \eqref{eq:decay_constant_def} and the PCAC relation in \eqref{eq:axial_ward_indiv}, we find
\begin{align}
  f_M = (m_a-m_b) \sqrt{2\over M^3} \left({a_0\over a^{3/2}}\right)\,,
  \label{eq:decayconstant_pseudoscalar}
\end{align}
where $a$ and $b$ are the two flavours the meson is charged under.

The above discussion can be straightforwardly generalized to 3-point correlation functions, from which we are able to extract quantities like the hadronic transition amplitudes $\langle M' | J | M \rangle$, from which we can determine semileptonic form factors. The generalization of the above for 3-point correlators is
\begin{align}
  \nonumber
  C(0,t,T) =& \langle \Omega | \, \Phi_{M'}(0)\, J(t)\, \Phi_{M}^{\dagger}(T)\, | \Omega \rangle
  \\ \nonumber
  =& \sum_{n,m}  \left( {\langle \Omega | \Phi_{M'} | \lambda_n \rangle \over \sqrt{2E_{M',m}}} \right) \left({\langle \lambda_n | J | \lambda_m \rangle \over 2\sqrt{ E_{M,n} E_{M',m} } }\right) \left( {\langle \lambda_m | \Phi_{M}^{\dagger} | \Omega \rangle \over \sqrt{2E_{M,n}} } \right) \\ \nonumber &\times f(\bar{E}_{M',m}\,,\,T-t) f(\bar{E}_{M,n}\,,\,t) \\
  \equiv& \sum_{n,m} a_{M',n} J_{nm} a^*_{M,m} \,\, f(\bar{E}_{M',m}\,,\,T-t) f(\bar{E}_{M,n}\,,\,t).
  \label{eq:3ptfitfunction}
\end{align}
I have suppressed spacial momentum dependence here for notational simplicity. $a_{M,n}$ will vanish for states $|\lambda_n\rangle$ that have different quantum numbers to $\Phi_{M}$, similarly for $a_{M',m}$ and $\Phi_{M'}$. Non-zero $a_{M,n}$'s will match the analagous parameters extracted from fitting a 2-point function $\langle \Phi_{M}^{\dagger} \Phi_{M} \rangle$, similarly for $a_{M',m}$'s and $\Phi_{M'}$. This carries on to the energies; $\{\bar{E}_{M,n}\}$ is the spectrum for the $M'$ meson, and $\{\bar{E}_{M'm}\}$ is the spectrum for the $M$. Therefore, we compute and fit the appropriate 2-point functions to deduce the parameters $\{a_{M^{(')},n}\}$,$\{\bar{E}_{M^{(')},n}\}$, then fitting $C(0,t,T)$ results in an accurate determination of the remaining free parameters, $J_{nm}$. This set contains the transition amplitude one is interested in $\langle M' | J | M \rangle$, recoginising that
\begin{align}
  J_{00} = {\langle M' | J | M \rangle \over 2\sqrt{E_{M,0} E_{M',0} } }\,.
\end{align}

\subsubsection{Oscillating States}

In the case of staggered quarks, these fit functions must be modified to contain the effects of the {\it{oscillating states}}. The oscillating states are due to propagation of mesons in the correlator containing the $\zeta=(1,0,0,0)$ taste of one of the valence quarks (in the language of Sec. \ref{sec:doubling_problem}). No other tastes contribute, since $\Phi({{\textbf{p}}},t)$ has a 3-momentum fixed at ${\textbf{p}}$, which we always take to be small relative to $\pi/a$. Hence $\Phi({\textbf{p}},t)$ does not couple to the states at $k\sim(0,\pi/a,0,0)$, $k\sim(0,0,\pi/a,0)$ etc. However, $\Phi({\textbf{p}},t)$ can couple to arbitrarily high energy states, so the pole at $k\sim(\pi/a,0,0,0)$ contributes.

How this taste contributes can be seen using the doubling symmetry. I will use a $B$ meson as an example. We can translate the $\zeta=(1,0,0,0)$ pole in momentum space down to around ${\textbf{p}}$ by the transform $\psi_l\to (i\gamma_5\gamma_0)(-1)^{t/a} \psi_l$ on the offending flavour, say it is the light quark $l$. This causes $\Phi_B({\textbf{p}},t)$ to become
\begin{align}
  \Phi_B({\textbf{p}},t) = \bar{\psi}_b\gamma_5\psi_l \to i(-1)^{t/a}\bar{\psi}_b\gamma_0\psi_l.
\end{align}
The $\zeta=(1,0,0,0)$ taste of the $l$-quark manifests itself as a scalar ($0^+$) meson with an oscillating phase $(-1)^{t/a}$.

Accounting for oscillating states modifies the fit functions to
\begin{align}
  \label{eq:2ptcorrelator_real}
  C_{\textbf{p}}(t)|_{\text{fit}} =& \sum_{j=0}^{N_{\text{exp}}} |a_j|^2 f(\bar{E}_j,t) + (-1)^{t/a} |a_{j,o}|^2 f(\bar{E}_{j,o},t)\, \\
  \nonumber
  C_{\textbf{p}}(t,T)|_{\text{fit}} =& \sum_{j,k=0}^{N_{\text{exp}},N_{\text{exp}}} \Big(\, a^{M}_j J^{nn}_{jk} a^{M'}_k f(\bar{E}^{M},t) f(\bar{E}^{M'}_n,T-t)
  \\ \nonumber
  &+a^{M,o}_j J^{on}_{jk} a^{M'}_k (-1)^{t/a} f(\bar{E}^{M,o}_n,t) f(\bar{E}^{M'},T-t)
  \\ \nonumber
  &+a^{M}_j J^{no}_{jk} a^{M',o}_k (-1)^{(T-t)/a} f(\bar{E}^{M},t) f(\bar{E}^{M',o}_n,T-t)
  \\
  &+a^{M,o}_j J^{oo}_{jk} a^{M',o}_k (-1)^{T/a} f(\bar{E}^{M,o}_n,t) f(\bar{E}^{M',o},T-t) \,\Big)\,.
  \label{eq:3ptcorrelator_real}
\end{align}

There is a special case where oscillating states do not contribute. If the two quarks in $\Phi({\textbf{p}},t)$ are degenerate (have the same flavour, momentum etc.) then the doubling symmetry acts on both of the quark fields identically. If the meson is a pseudoscalar, then the effect of the doubling symmetry cancels, and no oscillating states contribute:
\begin{align}
  \bar{\psi}\gamma_5 \psi \to (-1)^{2\times t/a} \bar{\psi} (i\gamma_5\gamma_0) \gamma_5 (i\gamma_5\gamma_0) \psi = \bar{\psi}\gamma_5\psi.
\end{align}

\subsubsection{Bayesian $\chi^2$ Fitting}

We use the \texttt{CorrFitter} package \cite{CorrFitter} for performing the $\chi^2$ fitting. We adopt a Bayesian approach first introduced in \cite{Lepage:2001ym}. Given a fit function $f_{\rho}(x)$ with parameters $\{\rho_{\alpha}\}$, a set of inputs $\{x_i\}$, and a set of corresponding observations $\{y_i\}$, with a covariance matrix $\sigma^y_{ij}$, the fitter minimizes
\begin{align}
  \chi^2 = \sum_{ij} {( f_{\rho}(x_i) - y_i )( f_{\rho}(x_j) - y_j )\over (\sigma_{ij}^y)^2} + \sum_{\alpha}\left({\rho_{\alpha}-\rho^{\text{prior}}_{\alpha}\over\sigma_{\alpha}^{\text{prior}}}\right)^2\,.
  \label{eq:chi2}
\end{align}
$\rho_{\alpha}^{\text{prior}}$ and $\sigma_{\alpha}^{\text{prior}}$ are the mean and standard deviations of the prior distributions given to the fit parameters. In our case, $x_i$ is the set of times $t$, $y_i$ are the correlators $C_i(t)$, and $\rho_{\alpha}$ are $a_n,E_n,J_{nm}$. Using this $\chi^2$ means we take into account all correlations between different timeslices $t$, and between different correlators.

The actual parameters $\rho_{\alpha}$ of these fits are slightly reparameterized from simply the amplitudes $a_j^M$, energies $E_j^M$ and transition amplitudes $J_{jk}$. Instead of energies, the fit parameters are log$(\delta E_j^M)$, where $\delta E_0=E_0^M$ and $\delta E_j=E_j^M-E_{j-1}^M$ for $j>0$. These are the parameters $\rho$ given to Eq. \eqref{eq:chi2}, this is equivalent to giving Gaussian prior distributions to these logs. This forbids the ground state energy to become negative or go arbitrarily close to zero in the fit. Similarly, for the excited-state differences $E_j^M-E_{j-1}^M$, setting Gaussian priors for the log of these enforces $E_j^M > E_{j-1}^M$, a large reduction in the space of possible solutions to the fit. Often the fit is also given log-amplitudes rather than amplitudes as fit parameters. This also prevents the amplitudes $a_j^M$ from becoming negative or zero. This is only an option when both the source and sink of the correlators being fitted have the same operator, otherwise, $a_j^M$ are not necessarily positive.

A common problem for large fits involving many correlators is that the data’s covariance matrix can be somewhat singular (very large condition number) if there are strong correlations in the data. This makes the inversion of the covariance matrix (for constructing $\chi^2$) susceptible to roundoff error. To address this we impose an {\it{svd cut}} $c_{\text{svd}}$. This replaces any eigenvalue of the covariance matrix smaller than $c_{\text{svd}} x$ with $c_{\text{svd}}x$, where $x$ is the largest eigenvalue in the matrix. This makes the matrix less singular. It can be considered a conservative move when it comes to the uncertainty of the results since the only possible effect this can have is to inflate those uncertainties.

\subsection{Signal Degredation}
\label{sec:signaldegredation}

A large obstacle in the analysis of correlation functions is \textit{signal degredation} \cite{Parisi:1983ae,Lepage:1989hd}.

A random variable $x$ has a mean and standard deviation
\begin{align}
  \hat{x} = \langle x \rangle\,,\quad
  \sigma^2 = {1\over N} ( \langle x^2 \rangle - \langle x \rangle^2 )\,,
\end{align}
where $N$ is the size of the sample. So the (square of) the signal/noise ratio is
\begin{align}
  {\hat{x}^2\over \sigma^2} = N \left( {\langle x^2 \rangle \over \langle x \rangle^2} - 1 \right) ^{-1}.
  \label{eq:signal-noise}
\end{align}
Consider 2-point correlators where $x = \Phi^{\dagger}(t) \Phi(0)$, and $\Phi$ is some meson creation operator.

In the $t\to T_{\text{lat}}/2$ limit, $\langle x^2 \rangle$ and $\langle x \rangle$ can be written as
\begin{align}
  \label{eq:meandecay}
  \langle x \rangle &= \sum_n {1\over 2E_n} \langle \Omega | \Phi^{\dagger}(t) | \lambda_n \rangle \langle \lambda_n | \Phi(0) | \Omega \rangle e^{-E_n t} \,\,\,{\sim}\,\,\, e^{-E_0 t}\,, \\
  \langle x^2 \rangle &= \sum_n {1\over 2E_n} \langle \Omega | \Phi^{\dagger 2}(t) | \lambda_n \rangle \langle \lambda_n | \Phi^2(0) | \Omega \rangle e^{-E_n t} \,\,\,{\sim}\,\,\, e^{-E'_0 t}\,.
  \label{eq:devdecay}
\end{align}
where we have assumed the ratio of matrix elements and energies are $\mathcal{O}(1)$. The operator $\Phi^2$ will contain two quark and two antiquark operators, connected by some matrices in spin space. $\Phi^2$ can create a combination of all possible 2 meson states where the mesons are made of the available flavours and quantum numbers. For example, for 2-point $D$-meson correlators ($c\bar{d}$ pseudoscalars), $E'_0 = (M_{\pi}+M_{\eta_c})$. Plugging $E_0=M_{D}$ and $E'_0=(M_{\pi}+M_{\eta_c})$ into Eqs. \eqref{eq:meandecay}, \eqref{eq:devdecay} and \eqref{eq:signal-noise}, we see that $D$ meson correlators have a signal/noise ratio that degrades like
\begin{align}
  {\hat{x}^2\over \sigma^2} \propto e^{-(M_{D}-(M_{\pi}+M_{\eta_c})/2)t}.
\end{align}

In general, a meson with two valence quarks of very different masses will suffer from a signal degrading exponentially with $t$. $B$-mesons suffer more than $D$-mesons. Adding spacial momentum to one of the quarks in the meson would have the effect of replacing $M_D$ in the above equation with some higher energy $E_D$, thus exacerbating the problem further.

Signal degradation strongly limits the types of calculations that can be performed in lattice QCD. In the context of semileptonic decays, it can limit the region of $q^2$ that form factors can be calculated.

%% \section{Renormalization of Currents}
%% \label{sec:renormalization}

%% Once one has computed an observable on the lattice, like $f_M$ or $\langle M' | J_{\mu} | M\rangle$, it needs to be translated into a continuum regularization scheme. Suppose we have some bare operator $\mathcal{O}_0$, we expect this to be related to the renormalized operator in $\overline{MS}$ at scale $\mu$, $\mathcal{O}^{\overline{MS}}(\mu)$, via
%% \begin{align}
%%   \mathcal{O}^{\overline{MS}}(\mu) = Z^{\overline{MS}}(\mu) \mathcal{O}_0.
%% \end{align}
%% Similarly, in a lattice regularization,
%% \begin{align}
%%   \mathcal{O}^{\text{lat}}(1/a) = Z^{\text{lat}}(1/a) \mathcal{O}_0.
%% \end{align}
%% Hence we expect a multiplicative factor between the lattice matrix elements, and the continuum $\overline{MS}$ ones:
%% \begin{align}
%%   \langle \mathcal{O} \rangle^{\overline{MS}} = \mathcal{Z}(\mu,1/a) \langle \mathcal{O} \rangle^{\text{lat}}
%% \end{align}
%% where $\mathcal{Z}(\mu,1/a) = Z^{\overline{MS}}(\mu)/Z^{\text{lat}}(1/a)$. These ``matching factors'' $\mathcal{Z}$ can be deduced by equating observables calculated in both lattice QCD and continuum (appropriately regularized) QCD, producing equations which can be solved for $\mathcal{Z}$. The lattice side of the calculation can be done either through lattice perturbation theory ({\it{perturbative matching}}), or through a lattice calculation ({\it{non-perturbative matching}}).

%% The result that conserved (or partially conserved) currents (and densities connected to those currents via Ward identities) do not receive any renormalization in any scheme, i.e. $Z^{\text{any}}=1$. They are said to be {\it{absolutely normalized}}.

%% In principle this is of great help, since the currents that mediate semileptonic decays, e.g. the weak vector and axial currents, are partially conserved, so we are not required to include any matching factors. However, in practice, this is complicated by the fact that the conserved current in the lattice theory is often computationally difficult or impossible to compute. For example, in NRQCD, the partially conserved current corresponding to $SU(N)_V$ is an infinite sum in $1/m_b$ where $m_b$ is the bottom mass. The corresponding current in HISQ is also the sum of a large number of operators. This can be interpreted as mixing in the renormalization:
%% \begin{align}
%%   \langle \mathcal{O}_i \rangle^{\overline{MS}} = \mathcal{Z}_{i,j} \langle \mathcal{O}_j \rangle^{\text{lat}}
%% \end{align}
%% Lattice calculations often use only the dominant operators that contribute to the conserved current. Since these will be ``close'' to the conserved current, one can expect the matching factor to only be a small deviation from unity, and the more sub-dominant operators you add, the overall matching factor should tend towards unity.

I have now introduced all of the relevant machinery for understanding the work of this thesis. The following three chapters cover research performed over the period of my PhD.
